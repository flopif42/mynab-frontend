<mat-sidenav-container class="app-shell" autosize>

  <mat-sidenav
    #drawer
    mode="side"
    opened
    [style.width.px]="_isSidenavCollapsed ? 60 : 200"
    class="side-nav"
  >
    <!-- Main nav items -->
    <mat-nav-list>
      <a mat-list-item routerLink="/user">
        <mat-icon matListItemIcon>manage_accounts</mat-icon>
        @if (!_isSidenavCollapsed) { <span>User profile</span> }
      </a>


      <a mat-list-item routerLink="/budget">
        <mat-icon matListItemIcon>account_balance_wallet</mat-icon>
        @if (!_isSidenavCollapsed) { <span>Budget</span> }
      </a>
      <a mat-list-item routerLink="/payee">
        <mat-icon matListItemIcon>person_apron</mat-icon>
        @if (!_isSidenavCollapsed) { <span>Payees</span> }
      </a>
      <a mat-list-item routerLink="/category">
        <mat-icon matListItemIcon>label</mat-icon>
        @if (!_isSidenavCollapsed) { <span>Categories</span> }
      </a>
      <a mat-list-item routerLink="/accounts">
        <mat-icon matListItemIcon>account_balance</mat-icon>
        @if (!_isSidenavCollapsed) { <span>All accounts</span> }
      </a>
    </mat-nav-list>

    <!-- If the sidenav is not collapsed, display list of accounts and "Add account" button -->
    @if (!_isSidenavCollapsed) {
        <mat-nav-list>
        @for (section of _accountSections; track section) {
	        <a mat-list-item (click)="toggleCollapse(section)" style="cursor: pointer;">
		        <mat-icon matListIcon>
			        {{ !isSectionCollapsed(section) ? 'expand_more' : 'chevron_right' }}
		        </mat-icon>
		        <span class="account_section">{{ _accountSections[section] }}</span>
	        </a>
            @if (!isSectionCollapsed(section)) {
	            @for (account of _accounts.get(section); track account.id) {
			    <a mat-list-item routerLink="/account/{{account.id}}">
                    <div class="account-row">
				        <div matLine class="account_name">{{ account.name }}</div>
				        <div matLine class="account_balance">{{ account.balance | formatAmount }}&euro;</div>
                    </div>
			    </a>
		        }
	        }
        }
        </mat-nav-list>
        <div class="add-account">
            <button mat-stroked-button color="primary" class="full-width">Add account</button>
        </div>  
    }
      
    <!-- Collapse/expand toggle at bottom -->
    <div class="toggle-btn">
        <button mat-icon-button (click)="toggleSidenav()">
            <mat-icon>{{ _isSidenavCollapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
        </button>
    </div>
  </mat-sidenav>

  <!-- Your page content goes here -->
  <mat-sidenav-content class="app-content">
    <router-outlet></router-outlet>
  </mat-sidenav-content>
</mat-sidenav-container>
