<br/>
<form>
<table class="budget">
    <tr>
        <th class="empty">&nbsp;</th>
        @for (budget_line of _budget; track budget_line.id_period) {
            <th class="period" colspan="3">{{ budget_line.id_period }}</th>
        }
    </tr>

    <tr>
        <td class="empty">&nbsp;</td>
        @for (budget_line of _budget; track budget_line.id_period) {
            <td>Budgeted</td><td>Outflows</td><td>Remaining</td>
        }
    </tr>

    @for (parent_cat of _parentCategories; track parent_cat.id) {
    <tr>
        <td class="parent_cat">{{ parent_cat.name }}</td>
        @for (budget_line of _budget; track budget_line.id_period) {
            <td class="parent_cat" colspan="3">&nbsp;</td>
        }
    </tr>
        @for (allCat of parent_cat['child_categories']; track allCat.id) {
            <tr class="subcategory">
                <td>{{ allCat.name }}</td>
                @for (budget_line of _budget; track budget_line.id_period) {
                    @let budgetedCat = getCategoryBudgetLine(budget_line.id_period, allCat.id);
                    @if (budgetedCat) {
                        <td class="budget_amount subcategory">
                            @if (budgetedCat.funded > 0) { <input class="budget_amount" name="funded" value="{{ budgetedCat.funded | formatAmount }}"> } @else { &nbsp; }
                        </td>
                        <td class="budget_amount">
                            @if (budgetedCat.funded > 0) { {{ budgetedCat.spent | formatAmount }} } @else { &nbsp; }
                        </td>
                        <td class="budget_amount" [class.overspent]="budgetedCat.remaining < 0">{{ budgetedCat.remaining | formatAmount }}</td>
                    } @else {
                        <td class="budget_amount subcategory"><input name="funded" class="budget_amount"></td>
                        <td class="budget_amount">&nbsp;</td>
                        <td class="budget_amount">&nbsp;</td>
                    }
                }
            </tr>
        }
    }
</table>
</form>